const Mixin=t=>{const e=new WeakSet;return s=>{let i=s;for(;null!=i;){if(e.has(i))return s;i=Object.getPrototypeOf(i)}const r=t(s);return e.add(r),r}},BaseMixin=Mixin(t=>(class extends t{toggleAttribute(t,e){return null!=e?e?this.setAttribute(t,""):this.removeAttribute(t):this.hasAttribute(t)?this.removeAttribute(t):this.setAttribute(t,""),e||this.hasAttribute(t)}})),connector=t=>{const e=new WeakMap;return(s,i)=>(class extends s{connectedCallback(){const{selectors:s,actions:r}=i;if(s){const i=()=>Object.assign(this,s(t.getState())),r=t.subscribe(i);e.set(this,r),i()}if(r){const e=r(t.dispatch);for(const t in e)this.addEventListener(t,s=>{s.stopImmediatePropagation(),e[t](s.detail)})}super.connectedCallback&&super.connectedCallback()}disconnectedCallback(){if(i.selectors){e.get(this)()}super.disconnectedCallback&&super.disconnectedCallback()}})},PropertyChangedMixin=Mixin(t=>{const e=new WeakMap;let s=!1;return class extends t{static setup(){if(s)return;const t=this.prototype,i=this.properties,r=Object.keys(i);for(const s of r){function n(){return e.get(this)[s]}function o(t){const i=e.get(this)[s];e.get(this)[s]=t,this.propertyChangedCallback(s,i,t)}s in t||Object.defineProperty(t,s,{configurable:!0,enumerable:!0,get:n,set:o})}s=!0}constructor(){super(),e.set(this,{}),this.constructor.setup()}connectedCallback(){const t=this.constructor.properties,e=Object.keys(t);for(const t of e){if(!this.hasOwnProperty(t))continue;const e=this[t];delete this[t],this[t]=e}super.connectedCallback&&super.connectedCallback()}propertyChangedCallback(t,e,s){}set(t){const s=Object.entries(t),i={},r=e.get(this);for(const[t,e]of s)i[t]=r[t],r[t]=e;for(const[t,e]of s){const s=i[t];this.propertyChangedCallback(t,s,e)}}}}),PropertyObserverMixin=Mixin(t=>{const e=PropertyChangedMixin(t);return class extends e{propertyChangedCallback(t,e,s){super.propertyChangedCallback(t,e,s);const i=this.constructor.properties[t].observer;null!=i&&this[i](s,e)}}});function toDashCase(t){return t.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()}const PropertyReflectionMixin=Mixin(t=>{const e=PropertyChangedMixin(t),s=new Map;let i=!1;return class extends e{static setup(){if(super.setup(),i)return;const t=this.properties,e=Object.keys(t);for(const i of e){if(t[i].reflectToAttribute){const t=toDashCase(i);s.set(i,t)}}i=!0}propertyChangedCallback(t,e,i){if(super.propertyChangedCallback(t,e,i),e===i)return;const r=this.constructor.properties[t],n=r.type;if(r.reflectToAttribute){const e=s.get(t);!1===i?this.removeAttribute(e):n===Boolean?this.setAttribute(e,""):this.setAttribute(e,i)}}}}),PropertiesMixin=Mixin(t=>{const e=PropertyReflectionMixin(PropertyObserverMixin(PropertyChangedMixin(t)));return class extends e{}}),ControlMixin=Mixin(t=>{const e=PropertiesMixin(BaseMixin(t)),s=Symbol(),i=Symbol();return class extends e{static get properties(){return Object.assign({},super.properties,{role:{type:String,reflectToAttribute:!0},name:{type:String,reflectToAttribute:!0},value:{type:String,reflectToAttribute:!0,observer:s},required:{type:Boolean,reflectToAttribute:!0,observer:i}})}constructor(){super(),this.required=!1}get valid(){return null!=this.value||!this.required}[s](t,e){t!==e&&(this.setAttribute("aria-invalid",!this.valid),this.toggleAttribute("valid",this.valid))}[i](t,e){t!==e&&(this.setAttribute("aria-required",t),this.setAttribute("aria-invalid",!this.valid),this.toggleAttribute("valid",this.valid))}}}),FocusMixin=Mixin(t=>{const e=PropertiesMixin(BaseMixin(t)),s=Symbol();return class extends e{static get properties(){return Object.assign({},super.properties,{disabled:{type:Boolean,reflectToAttribute:!0,observer:s},focused:{type:Boolean,reflectToAttribute:!0}})}constructor(){super(),this.focused=!1,this.disabled=!1}[s](t,e){t!==e&&(this.setAttribute("aria-disabled",String(t)),t?(this.removeAttribute("tabindex"),this.blur()):this.setAttribute("tabindex","0"))}focus(){this.disabled||(super.focus(),this.focused=!0,this.dispatchEvent(new FocusEvent("focus")),this.dispatchEvent(new FocusEvent("focusin",{bubbles:!0})))}blur(){this.disabled||(super.blur(),this.focused=!1,this.dispatchEvent(new FocusEvent("blur")),this.dispatchEvent(new FocusEvent("focusout",{bubbles:!0})))}}}),StaticTemplateMixin=Mixin(t=>(class extends t{constructor(){super(),this.constructor.hasOwnProperty("template")&&this.attachShadow({mode:"open"})}connectedCallback(){const t=this.constructor;if(t.hasOwnProperty("template")){const e=t.template.content;this.shadowRoot.appendChild(e.cloneNode(!0))}super.connectedCallback&&super.connectedCallback()}}));function sanitize(t){return t instanceof HTMLTemplateElement?t.innerHTML:String(t)}function html(t,...e){const s=t.raw,i=document.createElement("template");return i.innerHTML=e.reduce((t,e,i)=>t+sanitize(e)+s[i+1],s[0]),i}const ShadyCSS=window.ShadyCSS,emulated=ShadyCSS&&(!ShadyCSS.nativeShadow||!ShadyCSS.nativeCss),ShadyTemplateMixin=Mixin(t=>{const e=StaticTemplateMixin(t);let s=!1;return class extends e{constructor(){super();const t=this.constructor;s||null==t.template||(emulated&&ShadyCSS.prepareTemplate(t.template,this.localName),s=!0)}connectedCallback(){super.connectedCallback(),s&&emulated&&ShadyCSS.styleElement(this)}}}),ToggleMixin=Mixin(t=>{const e=PropertiesMixin(BaseMixin(t)),s=Symbol(),i=Symbol(),r=Symbol();return class extends e{static get properties(){return Object.assign({},super.properties,{checked:{type:Boolean,reflectToAttribute:!0,observer:r}})}constructor(){super(),this.checked=!1,this[s]=this[s].bind(this),this[i]=this[i].bind(this)}[r](t,e){t!==e&&(this.setAttribute("aria-checked",String(t)),this.dispatchEvent(new Event("input",{bubbles:!0})))}connectedCallback(){this.addEventListener("click",this[s]),this.addEventListener("keydown",this[i]),super.connectedCallback&&super.connectedCallback()}toggle(){this.disabled||(this.checked=!this.checked)}[s](){this.disabled||(this.toggle(),this.dispatchEvent(new Event("change",{bubbles:!0})))}[i](t){if(!this.disabled)switch(t.key){case"Enter":case" ":this.toggle(),this.dispatchEvent(new Event("change",{bubbles:!0}));break;default:return}}}});export{BaseMixin,connector,ControlMixin,FocusMixin,PropertiesMixin,PropertyChangedMixin,PropertyObserverMixin,PropertyReflectionMixin,ShadyTemplateMixin,StaticTemplateMixin,html,ToggleMixin};
