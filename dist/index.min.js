const Mixin=t=>{const e=new WeakSet;return i=>{let s=i;for(;null!=s;){if(e.has(s))return i;s=Object.getPrototypeOf(s)}const r=t(i);return e.add(r),r}},BaseMixin=Mixin(t=>(class extends t{toggleAttribute(t,e){return null!=e?e?this.setAttribute(t,""):this.removeAttribute(t):this.hasAttribute(t)?this.removeAttribute(t):this.setAttribute(t,""),e||this.hasAttribute(t)}})),connector=t=>{const e=new WeakMap;return(i,s)=>(class extends i{connectedCallback(){const{selectors:i,actions:r}=s;if(i){const s=()=>Object.assign(this,i(t.getState())),r=t.subscribe(s);e.set(this,r),s()}if(r){const e=r(t.dispatch);for(const t in e)this.addEventListener(t,i=>{i.stopImmediatePropagation(),e[t](i.detail)})}super.connectedCallback&&super.connectedCallback()}disconnectedCallback(){if(s.selectors){e.get(this)()}super.disconnectedCallback&&super.disconnectedCallback()}})},PropertyChangedMixin=Mixin(t=>{const e=new WeakMap;let i=!1;return class extends t{static setup(){if(i)return;const t=this.prototype,s=this.properties,r=Object.keys(s);for(const i of r){function n(){return e.get(this)[i]}function o(t){const s=e.get(this)[i];e.get(this)[i]=t,this.propertyChangedCallback(i,s,t)}i in t||Object.defineProperty(t,i,{configurable:!0,enumerable:!0,get:n,set:o})}i=!0}constructor(){super(),e.set(this,{}),this.constructor.setup()}connectedCallback(){const t=this.constructor.properties,e=Object.keys(t);for(const t of e){if(!this.hasOwnProperty(t))continue;const e=this[t];delete this[t],this[t]=e}super.connectedCallback&&super.connectedCallback()}propertyChangedCallback(t,e,i){}}}),PropertyObserverMixin=Mixin(t=>{const e=PropertyChangedMixin(t);return class extends e{propertyChangedCallback(t,e,i){super.propertyChangedCallback(t,e,i);const s=this.constructor.properties[t].observer;null!=s&&this[s](i,e)}}});function toDashCase(t){return t.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()}const PropertyReflectionMixin=Mixin(t=>{const e=PropertyChangedMixin(t),i=new Map;let s=!1;return class extends e{static setup(){if(super.setup(),s)return;const t=this.properties,e=Object.keys(t);for(const s of e){if(t[s].reflectToAttribute){const t=toDashCase(s);i.set(s,t)}}s=!0}propertyChangedCallback(t,e,s){if(super.propertyChangedCallback(t,e,s),e===s)return;const r=this.constructor.properties[t],n=r.type;if(r.reflectToAttribute){const e=i.get(t);!1===s?this.removeAttribute(e):n===Boolean?this.setAttribute(e,""):this.setAttribute(e,s)}}}}),PropertiesMixin=Mixin(t=>{const e=PropertyReflectionMixin(PropertyObserverMixin(PropertyChangedMixin(t)));return class extends e{}}),ControlMixin=Mixin(t=>{const e=PropertiesMixin(BaseMixin(t)),i=Symbol(),s=Symbol();return class extends e{static get properties(){return Object.assign({},super.properties,{role:{type:String,reflectToAttribute:!0},name:{type:String,reflectToAttribute:!0},value:{type:String,reflectToAttribute:!0,observer:i},required:{type:Boolean,reflectToAttribute:!0,observer:s}})}constructor(){super(),this.required=!1}get valid(){return null!=this.value||!this.required}[i](t,e){t!==e&&(this.setAttribute("aria-invalid",!this.valid),this.toggleAttribute("valid",this.valid))}[s](t,e){t!==e&&(this.setAttribute("aria-required",t),this.setAttribute("aria-invalid",!this.valid),this.toggleAttribute("valid",this.valid))}}}),FocusMixin=Mixin(t=>{const e=PropertiesMixin(BaseMixin(t)),i=Symbol();return class extends e{static get properties(){return Object.assign({},super.properties,{disabled:{type:Boolean,reflectToAttribute:!0,observer:i},focused:{type:Boolean,reflectToAttribute:!0}})}constructor(){super(),this.focused=!1,this.disabled=!1}[i](t,e){t!==e&&(this.setAttribute("aria-disabled",String(t)),t?(this.removeAttribute("tabindex"),this.blur()):this.setAttribute("tabindex","0"))}focus(){this.disabled||(super.focus(),this.focused=!0,this.dispatchEvent(new FocusEvent("focus")),this.dispatchEvent(new FocusEvent("focusin",{bubbles:!0})))}blur(){this.disabled||(super.blur(),this.focused=!1,this.dispatchEvent(new FocusEvent("blur")),this.dispatchEvent(new FocusEvent("focusout",{bubbles:!0})))}}}),StaticTemplateMixin=Mixin(t=>(class extends t{constructor(){super(),this.constructor.hasOwnProperty("template")&&this.attachShadow({mode:"open"})}connectedCallback(){const t=this.constructor;if(t.hasOwnProperty("template")){const e=t.template.content;this.shadowRoot.appendChild(e.cloneNode(!0))}super.connectedCallback&&super.connectedCallback()}}));function sanitize(t){return t instanceof HTMLTemplateElement?t.innerHTML:String(t)}function html(t,...e){const i=t.raw,s=document.createElement("template");return s.innerHTML=e.reduce((t,e,s)=>t+sanitize(e)+i[s+1],i[0]),s}const ShadyCSS=window.ShadyCSS,emulated=ShadyCSS&&(!ShadyCSS.nativeShadow||!ShadyCSS.nativeCss),ShadyTemplateMixin=Mixin(t=>{const e=StaticTemplateMixin(t);let i=!1;return class extends e{constructor(){super();const t=this.constructor;i||null==t.template||(emulated&&ShadyCSS.prepareTemplate(t.template,this.localName),i=!0)}connectedCallback(){super.connectedCallback(),i&&emulated&&ShadyCSS.styleElement(this)}}}),ToggleMixin=Mixin(t=>{const e=PropertiesMixin(BaseMixin(t)),i=Symbol(),s=Symbol(),r=Symbol();return class extends e{static get properties(){return Object.assign({},super.properties,{checked:{type:Boolean,reflectToAttribute:!0,observer:r}})}constructor(){super(),this.checked=!1,this[i]=this[i].bind(this),this[s]=this[s].bind(this)}[r](t,e){t!==e&&(this.setAttribute("aria-checked",String(t)),this.dispatchEvent(new Event("input",{bubbles:!0})))}connectedCallback(){this.addEventListener("click",this[i]),this.addEventListener("keydown",this[s]),super.connectedCallback&&super.connectedCallback()}toggle(){this.disabled||(this.checked=!this.checked)}[i](){this.disabled||(this.toggle(),this.dispatchEvent(new Event("change",{bubbles:!0})))}[s](t){if(!this.disabled)switch(t.key){case"Enter":case" ":this.toggle(),this.dispatchEvent(new Event("change",{bubbles:!0}));break;default:return}}}});export{BaseMixin,connector,ControlMixin,FocusMixin,PropertiesMixin,PropertyChangedMixin,PropertyObserverMixin,PropertyReflectionMixin,ShadyTemplateMixin,StaticTemplateMixin,html,ToggleMixin};
